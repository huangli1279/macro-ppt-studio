# 幻灯片 JSON 编写指南

本指南详细说明了 Macro PPT Studio 中幻灯片 JSON 的数据结构、编写规范及渲染规则。通过编写符合规范的 JSON，您可以精准控制幻灯片的布局与内容展示。

## 1. 核心结构

每个幻灯片由标题、论点（Content）和图表（Charts）三部分组成。

```json
{
  "title": "幻灯片标题",
  "content": [
    "论点1：核心观点陈述...",
    "论点2：补充说明或数据支撑..."
  ],
  "charts": [
    // 图表配置对象列表
  ]
}
```

- **title** (可选): 字符串，幻灯片的顶部标题。
- **content** (必填): 字符串数组，显示为左侧或顶部的文本列表。
- **charts** (必填): 图表对象数组，支持表格、ECharts 图表和图片。

---

## 2. 自动化布局规则

系统根据 `content` (论点数) 和 `charts` (图表数) 的数量自动选择最佳布局：

| 论点数 | 图表数 | 布局模式 | 描述 |
| :--- | :--- | :--- | :--- |
| **0-2** | **1** | **2+1 垂直堆叠** | 上部显示论点，下部全宽显示 1 个图表 |
| **0-2** | **2** | **2+2 垂直分栏** | 上部显示论点，下部左右并排显示 2 个图表 |
| **3** | **3** | **3+3 非对称布局** | **论点**：左 2 右 1<br>**图表**：左侧 1 个高图，右侧 2 个小图垂直堆叠 |
| **4** | **4** | **4+4 对称网格** | **论点**：2x2 排列<br>**图表**：2x2 网格排列 |
| **其他** | **其他** | **自适应布局** | 论点左右分栏，图表自动根据数量网格排列 |

> **提示**：为获得最佳视觉效果，建议尽量遵循上述标准数量组合（如 2+1, 2+2, 3+3, 4+4）。

---

## 3. 图表类型详解

`charts` 数组中的每个对象必须包含 `type` 和 `data` 属性。

### 3.1 表格 (Table)

表格数据采用**列式存储**（Column-oriented），即 Key 为列名，Value 为该列的数据数组。

**基础结构：**
```json
{
  "type": "table",
  "data": {
    "年份": [2021, 2022, 2023],
    "GDP增速": ["8.1%", "3.0%", "5.2%"]
  }
}
```

**带标题的表格：**
```json
{
  "type": "table",
  "data": {
    "title": "近三年主要经济指标",
    "data": {
      "指标": ["CPI", "PPI"],
      "数值": [2.1, 3.5]
    }
  }
}
```

**单元格样式完全定制：**
单元格不仅支持简单值，还支持对象格式来定义 CSS 样式。

```json
{
  "type": "table",
  "data": {
    "状态": [
      { 
        "value": "上涨", 
        "color": "red", 
        "font-weight": "bold",
        "background-color": "#ffe6e6" 
      },
      "持平",
      { 
        "value": "下跌", 
        "color": "green" 
      }
    ]
  }
}
```

### 3.2 ECharts 图表 (ECharts)

支持完整的 Apache ECharts 配置项。系统会自动注入默认配色和字体大小配置，您只需提供核心数据。

```json
{
  "type": "echarts",
  "data": {
    "title": { "text": "月度销售趋势" },
    "xAxis": { 
      "type": "category",
      "data": ["1月", "2月", "3月"] 
    },
    "yAxis": { "type": "value" },
    "series": [
      {
        "name": "销量",
        "type": "line",
        "data": [120, 200, 150]
      }
    ]
  }
}
```

**系统默认行为：**
- **配色**：自动应用红、蓝、浅蓝等专业配色方案。
- **字体**：根据全屏/缩略图模式自动调整字体大小。
- **布局**：自动调整 Grid 边距以适应屏幕。

### 3.3 图片 (Image)

用于展示外部 URL 图片。

```json
{
  "type": "image",
  "data": {
    "src": "https://example.com/chart-screenshot.png"
  }
}
```

---

## 4. 完整示例 (3+3 布局)

```json
{
  "title": "宏观经济季度分析",
  "content": [
    "观点1：工业生产保持平稳增长，高技术制造业表现亮眼。",
    "观点2：消费市场温和复苏，服务消费快于商品消费。",
    "观点3：出口面临一定压力，但结构持续优化。"
  ],
  "charts": [
    {
      "type": "echarts",
      "data": {
        "title": { "text": "工业增加值同比增速" },
        "xAxis": { "type": "category", "data": ["Q1", "Q2", "Q3", "Q4"] },
        "yAxis": { "type": "value" },
        "series": [{ "type": "bar", "data": [4.5, 3.8, 4.2, 5.0] }]
      }
    },
    {
      "type": "table",
      "data": {
        "title": "消费数据概览",
        "data": {
          "类别": ["社零总额", "餐饮收入"],
          "增速": [{"value": "7.2%", "color": "red"}, "10.5%"]
        }
      }
    },
    {
      "type": "echarts",
      "data": {
        "title": { "text": "出口结构占比" },
        "series": [
          {
            "type": "pie",
            "data": [
              { "value": 40, "name": "机电产品" },
              { "value": 20, "name": "纺织服装" },
              { "value": 40, "name": "其他" }
            ]
          }
        ]
      }
    }
  ]
}
```

## 5. 复杂实战示例 (一线城市消费分析)

展示了 ECharts 多列数据对比与表格 CSS 样式定制的结合。

```json
{
  "title": "一线城市中，广深上海社零增速基本回升到全国平均水平，北京持续下行",
  "content": [
    "北京总部型经济特征明显，跨区域设立经营主体明显增加，导致部分单位在京实现的零售额受到一定影响",
    "北京汽车类等大宗商品零售额下降18.3%，主要受燃油车牌获取难、成本高，燃油车市场需求不足影响",
    "国央企下达\"禁酒令\"等政策，削减宴请与商务消费，冲击高端消费市场"
  ],
  "charts": [
    {
      "type": "echarts",
      "data": {
        "title": {
          "text": "北上广深社会消费品零售总额累计同比(%)"
        },
        "xAxis": {
          "type": "category",
          "axisLabel": {
            "rotate": 45
          },
          "data": [
            "2024-02",
            "2024-03",
            "2024-04",
            "2024-05",
            "2024-06",
            "2024-07",
            "2024-08",
            "2024-09",
            "2024-10",
            "2024-11",
            "2024-12",
            "2025-02",
            "2025-03",
            "2025-04",
            "2025-05",
            "2025-06",
            "2025-07",
            "2025-08",
            "2025-09"
          ]
        },
        "yAxis": {},
        "series": [
          {
            "name": "全国",
            "type": "line",
            "smooth": true,
            "symbolSize": 0,
            "data": [
              5.5,
              4.7,
              4.1,
              4.1,
              3.7,
              3.5,
              3.4,
              3.3,
              3.5,
              3.5,
              3.5,
              4,
              4.6,
              4.7,
              5,
              5,
              4.8,
              4.6,
              {
                "value": 4.5,
                "label": {
                  "show": true,
                  "position": "right"
                }
              }
            ]
          },
          {
            "name": "北京",
            "type": "line",
            "smooth": true,
            "symbolSize": 0,
            "data": [
              2.6,
              -0.1,
              -0.2,
              1,
              -0.3,
              -0.8,
              -0.93,
              -1.6,
              -1.3,
              -2.8,
              -2.7,
              -0.1,
              -3.3,
              -3.7,
              -3.1,
              -3.8,
              -4.2,
              -5.1,
              {
                "value": -5.1,
                "label": {
                  "show": true,
                  "position": "right"
                }
              }
            ]
          },
          {
            "name": "上海",
            "type": "line",
            "smooth": true,
            "symbolSize": 0,
            "data": [
              1.9,
              0.1,
              -1.3,
              -0.7,
              -2.3,
              -2.8,
              -3.3,
              -3.4,
              -2,
              -3.1,
              -3.1,
              -1,
              -1.1,
              -0.3,
              1.4,
              1.7,
              2.5,
              3.7,
              {
                "value": 4.3,
                "label": {
                  "show": true,
                  "position": "bottom"
                }
              }
            ]
          },
          {
            "name": "广州市",
            "type": "line",
            "smooth": true,
            "symbolSize": 0,
            "data": [
              6.5,
              3.5,
              2.5,
              2,
              0,
              -0.3,
              -0.5,
              0.1,
              0.5,
              0.3,
              0,
              1.2,
              3.5,
              4,
              5.1,
              5.9,
              5.4,
              {
                "value": 4.9,
                "label": {
                  "show": true,
                  "position": "top"
                }
              },
              {
                "value": null,
                "label": {
                  "show": true,
                  "position": "right"
                }
              }
            ]
          },
          {
            "name": "深圳市",
            "type": "line",
            "smooth": true,
            "symbolSize": 0,
            "data": [
              5.6,
              4.3,
              2.3,
              1.8,
              1,
              1.2,
              1.1,
              0.7,
              1,
              1.5,
              1.1,
              1.7,
              3.1,
              3.7,
              4.7,
              3.5,
              3.6,
              {
                "value": 3.8,
                "label": {
                  "show": true,
                  "position": "bottom"
                }
              },
              {
                "value": null,
                "label": {
                  "show": true,
                  "position": "right"
                }
              }
            ]
          }
        ]
      }
    },
    {
      "type": "table",
      "data": {
        "日期": [
          "2502",
          "2503",
          "2504",
          "2505",
          "2506",
          "2507",
          "2508",
          "2509"
        ],
        "金银珠宝类": [
          29.2,
          29,
          35.2,
          41,
          36.1,
          32.7,
          35.7,
          33.5
        ],
        "体育娱乐用品类": [
          32.7,
          9.3,
          8.6,
          9.9,
          9.3,
          6.1,
          3.2,
          1.1
        ],
        "家用电器和音像器材类": [
          23.1,
          9.9,
          5.7,
          3.6,
          4.6,
          6.9,
          3.7,
          1.9
        ],
        "粮油食品类": [
          9.1,
          6.6,
          10.4,
          13.7,
          13.9,
          12.1,
          10,
          8.2
        ],
        "日用品类": [
          13.3,
          3.2,
          0.8,
          2.1,
          2.7,
          3.1,
          3.5,
          3.7
        ],
        "通讯器材类": [
          "/",
          "/",
          "/",
          -22.2,
          "/",
          -24.4,
          -26.2,
          -24.2
        ],
        "文化办公用品类": [
          20.8,
          1.4,
          "/",
          "/",
          3.1,
          "/",
          -11.9,
          -12
        ],
        "汽车类": [
          "/",
          "/",
          "/",
          -21.1,
          "/",
          -19,
          -19.4,
          -18.3
        ]
      }
    }
  ]
}
```
